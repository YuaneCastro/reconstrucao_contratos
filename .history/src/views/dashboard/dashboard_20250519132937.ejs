<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Painel do Encarregado</title>
  <link rel="stylesheet" href="/assets/css/dashboard.css">
</head>
<body>
  <div class="container">
    <!-- SIDEBAR -->
    <nav class="sidebar">
      <div>
        <h2>imagem da escola</h2>
        <ul>
            <strong>
          <li onclick="showSection('dashboard')">DASHBOARD</li>
          <li onclick="showSection('estudantes')">ESTUDANTES</li>
          <li onclick="showSection('contratos')"> DOCUMENTOS</li>
          <li onclick="showSection('log')">ATIVIDADES</li>
          <li onclick="showSection('normas')"> NORMAS</li>
          <li onclick="showSection('ajuda')">‚ùì Ajuda</li>
        </strong>     
        </ul>
      </div>

      <div class="footer">
        <p><strong>Contato:</strong></p>
        <p>üìû (99) 99999-9999</p>
        <p>üìß contato@escola.com</p>
        <p>üìç Rua das Flores, 123 ‚Äì Centro</p>
      </div>
    </nav>

    <!-- CONTE√öDO PRINCIPAL -->
    <main class="main">
      <!-- TOPBAR -->
      <div class="topbar">
        <div class="greeting">Ol√°, <strong><%= nome %></strong>!</div>
        <div class="actions">
          <button id="logout-button" onclick="informar()">Sair</button>
        </div>
      </div>

      <!-- CONTE√öDO DIN√ÇMICO -->
      <div class="content">
        <div id="dashboard" class="section active">
          <h3>Novos Documentos</h3>
          <% if(documentos_pendentes.length > 0){ %>
            <div class="documentos-grid">
              <% documentos_pendentes.forEach(doc => { %>
                <div class="documento-card">
                  <h4><%= doc.titulo %></h4>
                  <% if (!(doc.tipo === 'comunicado' && (!doc.estudante_id || !doc.estudante_nome))) { %>
                    <p><strong>Nome:</strong> <%= doc.estudante_nome %></p>
                  <% } %>
                  <p><strong>Tipo:</strong> <%= doc.tipo %></p>
                  <p><strong>Data de cria√ß√£o:</strong> <%= new Date(doc.data_emissao).toLocaleDateString('pt-BR') %></p>
                  <p><strong>Data de Expira√ß√£o:</strong>
                    <%= doc.data_expiracao ? new Date(doc.data_expiracao).toLocaleDateString('pt-BR') : 'N√£o definida' %>
                  </p>

                                   
                  <button 
                  onclick="handleViewContract(this)"
                  class="view-btn"
                  data-documento-id="<%= doc.documento_id %>"
                  data-id="<%= doc.assinatura_id %>"
                  data-id_encarregado="<%= doc.encarregado_id %>"
                  data-id_estudante="<%= doc.estudante_id %>"
                  data-titulo="<%= doc.titulo %>"
                  data-nome="<%= doc.estudante_nome %>"
                  data-tipo="<%= doc.tipo %>"
                  data-data_emissao="<%= doc.data_emissao %>"
                  data-data_expiracao="<%= doc.data_expiracao %>"
                  data-descricao="<%= doc.descricao || 'Sem descri√ß√£o' %>"
                  <%= doc.tipo === 'Contrato' ? 'Ver e Assinar' : 'Visualizar' %>
                  >üìÑ Ver e Assinar</button>
                                  
                </div>
              <% }); %>
            </div>
          <% } else { %>
            <p>Nenhum novo contrato.</p>
          <% } %>
        </div>
        <div id="visualizacaoContrato" class="section">
          <div class="header-section">
            <h2>Visualizar Documento</h2>
            <button onclick="showSection('dashboard')">üîô Voltar</button>
          </div>
          <div id="conteudoContrato"></div>
        </div>
        
        <div id="estudantes" class="section">
          <h3>Estudantes Representados</h3>
          <table>
            <thead>
                <tr>
                    <th>ID</th>
                    <th>NOME</th>
                    <th>Classe</th>
                    <th>Turma</th>
                    <th>Curso</th>
                    <th>Data Nascimento</th>
                </tr>
            </thead>
            <tbody>
                <% if(estudantes.length > 0){ %>
                    <% estudantes.forEach(student =>{  %>
                        <tr>
                          <td><%= student.id %></td>
                          <td><%= student.nome %></td>
                          <td><%= student.classe %></td>
                          <td><%= student.turma %></td>
                          <td><%= student.curso %></td>
                          <td><%= new Date(student.data_nascimento).toISOString().split('T')[0] %></td>
                        </tr>
                    <% });  %>   
                <% }else{ %>
                    <tr>
                        <td colspan="8">Nenhuma estudante encontrado.</td>
                    </tr>
                <% } %>
            </tbody>
        </table>
        </div>

        <div id="contratos" class="section">
          <h3>Documentos</h3>
          <% if(documentos.length > 0){ %>
            <div class="documentos-grid">
              <% documentos.forEach(doc => { %>
                <div 
                onclick="visualizarDocumento(this)"
                class="documento-card" 
                data-id="<%= doc.id %>" 
                data-nome="<%= doc.estudante_nome %>"
                data-titulo="<%= doc.titulo %>"
                data-tipo="<%= doc.tipo %>" 
                data-emissao="<%= new Date(doc.data_emissao).toLocaleDateString('pt-BR') %>" 
                data-expiracao="<%= doc.data_expiracao ? new Date(doc.data_expiracao).toLocaleDateString('pt-BR') : 'N√£o definida' %>"
                data-descricao="<%= doc.descricao %>">
                  <h4><%= doc.titulo %></h4>
                  <p><strong>Nome:</strong> <%= doc.estudante_nome %></p>
                  <p><strong>Tipo:</strong> <%= doc.tipo %></p>
                  <p><strong>Data de cria√ß√£o:</strong> <%= new Date(doc.data_emissao).toLocaleDateString('pt-BR') %></p>
                  <p><strong>Data de Expira√ß√£o:</strong>
                    <%= doc.data_expiracao ? new Date(doc.data_expiracao).toLocaleDateString('pt-BR') : 'N√£o definida' %>
                  </p>
                </div>
              <% }); %>
            </div>
          <% } else { %>
            <p>Nenhum contrato dispon√≠vel.</p>
          <% } %>
        </div>
        <div id="detalhes-documento" class="section">
          <button onclick="showSection('contratos')">üîô Voltar</button>
          <h3>Detalhes do Documento</h3>
          <div id="conteudo-detalhes"></div>
        </div>
        
        <div id="log" class="section">
          <h3>Registro de Atividades</h3>
          <table>
            <thead>
                <tr>
                    <th>A√á√ÉO</th>
                    <th>DETALHES</th>
                    <th>DATA</th>
                </tr>
            </thead>
            <tbody>
                <% if(log_atividade.length > 0){ %>
                    <% log_atividade.forEach(activity =>{  %>
                        <tr>
                            <td><%= activity.acao %></td>
                            <td><%= activity.detalhes %></td>
                            <td><%= new Date(activity.data_hora).toISOString().split('T')[0] %></td>
                        </tr>
                    <% });  %>   
                <% }else{ %>
                    <tr>
                        <td colspan="8">Nenhuma acao encontrada.</td>
                    </tr>
                <% } %>
            </tbody>
        </table>
        </div>

        <div id="normas" class="section">
          <nav>
            <a href="#gerais">Normas Gerais</a>
            <a href="#conduta">Conduta em Sala</a>
            <a href="#avaliacao">Avalia√ß√£o e Tarefas</a>
            <a href="#disciplina">Disciplina</a>
          </nav>
        
          <section id="gerais">
            <h2>üìö Normas Gerais da Escola</h2>
            <small><em>Aplic√°vel a todos os alunos em qualquer √°rea da escola</em></small>
            <ul>
              <li>Todos os alunos devem chegar no hor√°rio estabelecido para as aulas.</li>
              <li>Faltas devem ser justificadas pelos respons√°veis, preferencialmente por escrito.</li>
              <li>O uso do uniforme completo √© obrigat√≥rio em todos os dias letivos.</li>
              <li>Uniformes devem estar limpos e em bom estado de conserva√ß√£o.</li>
              <li>O respeito entre alunos, professores e demais funcion√°rios √© essencial.</li>
              <li>√â proibido qualquer tipo de agress√£o f√≠sica, verbal ou moral dentro do ambiente escolar.</li>
              <li>Zelar pelo patrim√¥nio da escola √© responsabilidade de todos.</li>
              <li>N√£o √© permitido danificar carteiras, paredes, livros ou qualquer outro bem da escola.</li>
            </ul>
          </section>
        
          <section id="conduta">
            <h2>üí° Normas de Conduta em Sala de Aula</h2>
            <small><em>Aplic√°vel exclusivamente durante as aulas em sala</em></small>
            <ul>
              <li>O uso de celulares s√≥ ser√° permitido com autoriza√ß√£o do professor.</li>
              <li>Durante provas, celulares devem ser desligados e guardados.</li>
              <li>N√£o √© permitido comer dentro da sala de aula, exceto com autoriza√ß√£o.</li>
              <li>O consumo de alimentos deve ser feito nos intervalos e no refeit√≥rio.</li>
              <li>Levante a m√£o antes de falar ou fazer perguntas durante a aula.</li>
              <li>Evite conversas paralelas para n√£o atrapalhar a aula.</li>
            </ul>
          </section>
        
          <section id="avaliacao">
            <h2>üß≠ Normas de Avalia√ß√£o e Tarefas</h2>
            <small><em>Aplic√°vel a todos os momentos de entrega de atividades e provas</em></small>
            <ul>
              <li>Trabalhos escolares devem ser entregues no prazo estipulado pelo professor.</li>
              <li>Atrasos sem justificativa podem acarretar em perda parcial ou total da nota.</li>
              <li>Faltas em provas devem ser justificadas para remarcar a avalia√ß√£o.</li>
              <li>√â proibido qualquer tipo de fraude ou cola durante as avalia√ß√µes.</li>
            </ul>
          </section>
        
          <section id="disciplina">
            <h2>üõë Normas Disciplinares</h2>
            <small><em>Aplic√°vel a todos os comportamentos dentro da escola</em></small>
            <ul>
              <li>Atos de indisciplina ser√£o avaliados pela coordena√ß√£o pedag√≥gica.</li>
              <li>Advert√™ncias podem ser verbais, escritas ou resultar em suspens√£o.</li>
              <li>A escola prioriza o di√°logo e atitudes corretas em conjunto.</li>
              <li>Os respons√°veis ser√£o comunicados em caso de comportamento inadequado.</li>
            </ul>
          </section>
        </div>
      </div>
    </main>
  </div>
  
  <script src="/assets/js/dashboard.js"></script>
</body>
</html>
